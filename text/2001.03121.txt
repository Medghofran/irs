Astronomy & Astrophysics manuscript no. article_new January 10, 2020  c(cid:13)ESO 2020  A Precise Analytical Approximation for the Deprojection of the  Sérsic Proﬁle  Eduardo Vitral1 and Gary A. Mamon1  Institut d’Astrophysique de Paris (UMR 7095: CNRS & Sorbonne Université), 98 bis Bd Arago, F-75014 Paris, France  Received; accepted  ABSTRACT  The Sérsic model is known to ﬁt well the surface brightness (or surface density) proﬁles of elliptical galaxies and galaxy bulges, and possibly for dwarf spheroidal galaxies and globular clusters. The deprojected density and mass proﬁles are important for many astrophysical applications, in particular for mass-orbit modeling of these systems. However, the exact deprojection formula for the Sérsic model employs special functions not available in most computer languages. We show that all previous analytical approximations to the 3D density proﬁle are imprecise at low Sérsic index (n (cid:46) 1.5). We have derived a more precise analytical approximation to the deprojected Sérsic density proﬁle by ﬁtting two-dimensional 10th-order polynomials to the diﬀerences of the logarithms of the numerical deprojection and of the analytical approximation by Lima Neto et al. (1999, LGM) of the density proﬁle on one hand and of the mass proﬁle on the other. Our LGM-based polynomial ﬁts have typical relative precision better than 0.2% for both density and mass proﬁles, for Sérsic indices 0.5 ≤ n ≤ 10 and radii 0.001 < r/Re < 1000. Our approximation is much more precise than those of LGM, Simonneau & Prada (1999, 2004), Trujillo et al. (2002) for non-half-integer values of the index, and of Emsellem & van de Ven (2008) for non-one-tenth-integer values with n (cid:46) 3, and are nevertheless more than 0.2% precise for larger Sérsic indices, for both density and mass proﬁles. An appendix compares the deprojected Sérsic proﬁles with those of the popular simple models from Plummer (1911), Jaﬀe (1983), Hernquist (1990), Navarro et al. (1996), and Einasto (1965). Key words. Galaxies: structure – Galaxies: bulges – Galaxies: elliptical and lenticular, cD – (Galaxy:) globular clusters: general – Methods: numerical  −bn  (cid:32) R  Re  (cid:33)1/n ,  1. Introduction The Sérsic model (Sérsic 1963; Sersic 1968) is the generaliza- tion of the R1/4 law (de Vaucouleurs 1948) to describe the sur- face brightness proﬁles of elliptical galaxies (Caon, Capaccioli, & D’Onofrio 1993) and the bulges of spiral galaxies (Simard et al. 2011). It has also been used to describe the surface density proﬁles of nuclear star clusters (Carson et al. 2015), resolved dwarf spheroidal galaxies (Battaglia et al. 2006) and globular clusters (Barmby et al. 2007).  The surface (mass or number) density (or equivalently sur-  face brightness) of the Sérsic model is  Σ(R) = Σ0 exp  (1)  where R is the projected distance to the source center in the plane-of-sky (POS), Re is the eﬀective radius containing half of the projected luminosity, n is the Sérsic index and Σ0 is the cen- tral surface density. The term bn is a function of n, obtained by solving the equation:  where γ(a, x) = (cid:82) x  Γ(2n)/2 = γ(2n, bn) ,  (2) 0 ta−1e−tdt is the lower incomplete gamma Since the Sérsic model represents well astronomical objects viewed in projection, it is important to know its corresponding  function.  Send oﬀprint requests to: Eduardo Vitral, e-mail: vitral@iap.fr  three-dimensional (3D) density and mass proﬁles. These serve as a reference to compare to other possible observational tracers, as well as to dark matter. Moreover, the 3D density proﬁle is re- quired for modeling the kinematics of spherical structures, since it appears in the Jeans equation of local dynamical equilibrium. Since the Jeans equation also contains the total mass proﬁle, the 3D mass proﬁles of stellar components are required to estimate the dark matter mass proﬁle of elliptical and dwarf spheroidal galaxies.  Many authors assume that simple three-dimensional models resemble Sérsic models for certain values of the Sérsic index: It is often assumed that massive ellipticals and spiral bulges are well represented by the Hernquist (1990) model (e.g., Widrow & Dubinski 2005). On the other hand, dwarf spheroidal galax- ies are often described as a Plummer (1911) model (e.g. Muñoz et al. 2018, who also tried Sérsic and other models), while ultra diﬀuse galaxies have been described by Einasto (Einasto 1965; Navarro et al. 2004) models (Nusser 2019). Łokas & Mamon (2001) noted that the projected Navarro, Frenk, & White (1996, hereafter NFW) model resembles an n = 3 Sérsic for reasonable concentrations. Finally, n = 4 Sérsic models are considered to resemble the Jaﬀe (1983) model (Ciotti, Mancino, & Pellegrini 2019). In Appendix A, we compare these models to the depro- jected Sérsic.  Unfortunately, the deprojection of the Sérsic surface density proﬁle to a 3D (mass or number)1 density proﬁle, through Abel  1 The number proﬁle always has the same form as the mass proﬁle, and is obtained by simply replacing M(r) by N(r) and M∞ by N∞, e.g. in Eqs. (6), (7), and (17).  Article number, page 1 of 8  0 2 0 2     n a J    9      ]  .  A G h p - o r t s a [      1 v 1 2 1 3 0  .  1 0 0 2 : v i X r a  A&A proofs: manuscript no. article_new  dΣ dR  dR√ R2 − r2  ,  (3)  (cid:90) +∞  (1826) inversion ρ(r) = − 1 π (cid:90) r  r  M(r) =  4πs2ρ(s) ds ,  0  (e.g., Binney & Mamon 1982), as well as the corresponding 3D mass (or number) proﬁle  (4)  both involve the complicated Meijer G special function (Mazure & Capelato 2002 for integer values of n, and Baes & Gentile 2011 for general values of n) or the other complicated Fox H function (Baes & van Hese 2011), neither of which are available in popular computer languages.  Following the shape of the analytical approximation to the R1/4 law by Mellier & Mathez (1987), Prugniel & Simien (1997, hereafter, PS) proposed an analytical approximation for the 3D density of the Sérsic proﬁle:  (cid:33)−pn  (cid:32) r  Re  −bn  (cid:32) r  Re  (cid:33)1/n ,  ρPS(r) = ρ0  exp  which yields a simple analytical form for the 3D mass proﬁle  MPS(r) = M∞ γ[(3 − pn) n, bn (r/Re)1/n] M∞ = 4π ρ0 R3 e  Γ[(3 − pn) n] n Γ[(3 − pn) n] b(3−pn) n  ,  n  ,  (6)  (7)  where pn is a function depending only on n. PS calculated this dependence to be: pn,PS = 1 − 0.594 n  0.055  (8)  n2  +  ,  while Lima Neto, Gerbal, & Márquez (1999) (hereafter, LGM) later perfected this approximation with pn,LGM = 1 − 0.6097  0.05463  (9)  +  .  n  n2  LGM indicate that equation (9) is good to 5 per cent relative ac- curacy for 0.56 ≤ n ≤ 10 and −2 < log(r/Re) < 3. However, the power-law approximation at small radii is unjustiﬁed for small n. Indeed, as shown by Baes & Gentile (2011), the central den- sity proﬁle converges to a ﬁnite value for n < 1 (and the inner density proﬁle diverges only logarithmically for n = 1), as we will illustrate in Sect. 3.  Simonneau & Prada (1999, 2004, hereafter SP) proposed the  quasi-Gaussian expansion for the density proﬁle  −bnλ j  (cid:32) r  Re  (cid:33)1/n , (10)  ρ j exp  2 π  Re  Σ0 Re  bn (n−1)  (cid:32) r (cid:17)−1/(n−1) 1 − x2 (cid:113) 1 −(cid:16)  x j 1 − x2  ,  j  j  (cid:16)  (cid:33)1/n−1 5(cid:88)  j=1  (cid:17)2n/(n−1)  ,  ρSP(r) =  where  λ j =  ρ j = w j  (11)  (12)  Fig. 1. Variation with Sérsic index of the diﬀerent parameters of the an- alytical approximation of Emsellem & van de Ven (2008) for the depro- jected Sérsic density proﬁle (ﬁlled circles). The solid and dotted curves show the spline cubic and linear interpolations, respectively. At small n, the parameters vary abruptly and the interpolations (both linear and cubic) are thus uncertain.  not the same) form as the PS/LGM one, hence a similar shape for the mass proﬁle:  (5)  MSP(r) = M∞  4  π (n − 1) Γ(2n)  2n + 1, bnλ j  (cid:32) r  Re  (cid:33)1/n .  (13)  ρ j λ2n+1  j  γ  × 5(cid:88)  j=1  Trujillo et al. (2002) proposed an ellipsoid formula, which in  the limit of spherical symmetry becomes  ρT(r) =  2(n−1)/(2n) bn  π n  rpn(1/n−1)  Σ0 Re  1 −(cid:80)2  Kνn (r/Re) i=0 an,i logi (r/Re)  ,  (14)  where Kν(x) is the modiﬁed Bessel function of the 2nd kind2 of index ν, while νn, pn, an,0, an,1, and an,2 are empirical functions of index n. Trujillo et al. only provided their results for integer and half-integer values of n for n ≤ 5 and only integer values of n beyond. Emsellem & van de Ven (2008, hereafter EV) repeated their analysis on a ﬁner grid of n, with steps of 0.1 for 0.5 ≤ n ≤ 1.5 and with one more term, an,3, in equation (14), involving 168 parameters. Unfortunately, as shown in Figure 1, these functions vary abruptly for n (cid:46) 1.2. Moreover, neither Trujillo et al. nor Emsellem & van de Ven provide analytical forms for the mass proﬁle.  In summary, all the previous approximations to the depro-  jected Sérsic model have drawbacks:  – PS, LGM (and Márquez et al. 2000, which is the same as LGM, but with a slightly diﬀerent last term for pn, which was a typo) are inappropriate for low n (Baes & Gentile 2011) and less precise than claimed (Emsellem & van de Ven 2008). – SP is limited to n ≥ 1, and is generally less precise than EV. – Trujillo et al. (2002) is only given for half-integer values of n and their parameters vary wildly with n for n ≤ 1.5. They do not provide a formula for the mass proﬁle. – EV also suﬀers from discrete values of n, even though the grid is ﬁner (∆n = 0.1 for n ≤ 1.5). EV also did not provide a formula for the mass proﬁle.  where x j and w j are 10 ﬁt parameters. The individual SP density proﬁles (the terms inside the sum of Eq. 10) have a similar (but  2 Trujillo et al. (2002) call this the modiﬁed Bessel function of the 3rd kind, as some others do.  Article number, page 2 of 8  0.50.81.11.42.54.05.57.08.5n−1012Emsellem&vandeVen(2008)LinearinterpolationCubicsplineinterpolationνpa0a110×a210×a3Emsellem&vandeVen(2008)LinearinterpolationCubicsplineinterpolationVitral & Mamon: Deprojection of the Sérsic Proﬁle  In this article, we provide polynomial ﬁts to the log residuals of the LGM approximation, allowing to reach high accuracy for both the 3D density and 3D mass proﬁles in a wide range of Sérsic indices. In Sect. 2, we present the mathematical formalism and brieﬂy explain our numerical integration method. We then show in Sect. 3 how our polynomial plus LGM approximation is orders of magnitude more precise than the formulae of LGM, SP, and Trujillo et al. (2002), as well as that of EV for low n and only slightly worse for n >∼ 3. We conclude and discuss our results in Sect. 4.  2. Method 2.1. Equations using dimensionless proﬁles We express the general surface density, 3D density, and 3D mass (or number) proﬁles in terms of dimensionless functions:  Σ(R) =  M∞ πR2 e  (cid:101)Σ (cid:32) M∞ M(r) = M∞ (cid:101)M  ρ(r) =  4πR3 e  ,  (cid:33) (cid:32) r (cid:33)  (cid:32) R (cid:33)(cid:101)ρ (cid:32) r  Re  Re  .  Re  (cid:33)  ,  (15)  (16)  (17)  Hereafter, we will use x = r/Re and X = R/Re. For the Sérsic model, the dimensionless surface density proﬁle is  (cid:101)ΣS(X) =  b2n n  2n Γ(2n)  exp  (cid:16)−bn X1/n(cid:17)  ,  (18)  while for the PS model, one can write the dimensionless 3D den- sity and mass proﬁles as  (cid:104)−bnx1/n(cid:105)  ,  (19)  (20)  It is easy to show that the deprojection equation (3) becomes  (cid:101)ρPS(x) = (cid:101)MPS(x) =  n  b(3−pn) n  n Γ(cid:2)(3 − pn) n(cid:3) x−pn exp (3 − pn) n, bn X1/n(cid:105) (cid:104)  γ  .  Γ((3 − pn) n) (cid:90) +∞ d(cid:101)Σ  ,  x  n  π  dX  dX  where  X−1+1/n exp  (cid:101)ρ(x) = − 4 dX√ X2 − x2 d(cid:101)Σ ≡(cid:101)Σ(cid:48)(X) = − b2n+1 (cid:90) x (cid:90) x (cid:101)M(x) = y2(cid:101)ρ(y) dy = − 4 (cid:90) ∞ (cid:90) x X2(cid:101)Σ(cid:48)(X) dX − 2 (cid:90) ∞ X2 − x2(cid:101)Σ(cid:48)(X) dX ,  The dimensionless mass proﬁle is  2n2 Γ(2n)  = −  y2 dy  √  +  x  π  π  0  0  0  x  2 π  x  .  (cid:16)−bnx1/n(cid:17) (cid:90) ∞ (cid:101)Σ(cid:48)(X) (cid:112) (cid:19)(cid:101)Σ(cid:48)(X) dX (cid:18) x X2 − y2  y  X  X2 sin−1  dX (23)  (24)  where equation (24) is obtained by inversion of the order of in- tegration in the second equality of Eq. (23).  (cid:90) Xcrit (cid:16)−bnX1/n (cid:17)  a  2.2. Numerical integration We numerically evaluated the dimensionless 3D density (Eq. [21]) and mass (Eq. [24]) proﬁles by peforming the numer- ical integrations in cells 50 × 100 of [log n, log(r/Re)], with log 0.5 ≤ log n ≤ 1 and −3 ≤ log(r/Re) ≤ 3. Numerical calcu- lations were done with Python’s scipy.integrate.quad. For both density and mass proﬁles, we split the numerical integration in (cid:90) b two, i.e.  (cid:90) b  f (X) dX =  f (X) dX +  f (X) dX ,  (25)  a  Xcrit  crit  = 10−9 and a ≤ Xcrit ≤ b. We used a rel- where exp ative tolerance of epsrel = 10−4 and limit = 1000 in both integrals. If Xcrit (cid:60) [a, b], we also used epsrel = 10−4 and limit = 1000, but for a single integral from a to b.  We performed our analysis using either the highly accurate approximations for bn of Ciotti & Bertin (1999, hereafter, CB) or the exact (numerical) solutions of Eq. (2). We noticed that the diﬀerence between these two approaches was negligible (see Sect. 3). We  two-dimensional  (cid:104)(cid:101)MLGM(x, n)/(cid:101)M(x, n) (cid:105)  polynomials  and  log  both for  to  ,  geometrically spaced x and n, i.e. writing  then ﬁt  log(cid:2)(cid:101)ρLGM(x, n)/(cid:101)ρ(x, n)(cid:3) k−i(cid:88) = − k(cid:88) (cid:104)(cid:101)fLGM/(cid:101)f (cid:105)  log  ai j logi x log j n  (26)  i=0  j=0  with polynomial orders 2 ≤ k ≤ 12. For this, we used Python’s package numpy.linalg.lstsq. We found the smallest residuals for order 10 polynomials when using both the bn approximation of CB and bn by numerically solving Eq. (2). The coeﬃcients are provided in Tables B.1, B.2, B.3 and B.4 in Appendix B. In the rest of the paper, we present the results relative to the CB ap- proximation, since it is a simpler and more used model, and also because our order 10 polynomial ﬁts remarkably well the exact bn case.  2.3. Numerical precision: Tests for known simple analytical  deprojections (n = 0.5 and 1)  For Sérsic indices n = 0.5 and n = 1, there are analytical solu- tions for the 3D density proﬁle:  (21)  (22)  (cid:101)ρ(x) =    (cid:104)−b0.5 x2(cid:105)  b3/2 0.5√ π  exp  b3 1 π  K0(b1x)  4  2  (n = 0.5) ,  (n = 1) ,  (27)  where K0(x) is the modiﬁed Bessel function of the second kind of index 0. We can therefore verify the numerical integration of Eq. (21) for these two Sérsic indices. For the interval −3 ≤ log(r/Re) ≤ 3, we compared the den- good, with root-mean-square (rms) values of log ((cid:101)ρana/(cid:101)ρnum) of sities from numerical integration with the analytical formulae of Eq. (27), using the CB approximation for bn. The match is very 1.5 × 10−7 and 2 × 10−8 for n = 0.5 and n = 1, respectively. The same comparison using the exact bn yields 7×10−5 and 2×10−8, respectively (with one particular value of r causing the higher rms for n = 0.5).  Article number, page 3 of 8  A&A proofs: manuscript no. article_new  Table 1. Accuracy of approximations to 3D density and mass proﬁles  rms  (cid:32)(cid:101)ρapprox(cid:101)ρnum  (cid:33)  log  rms  (cid:101)Mapprox(cid:101)Mnum    Author  log  Prugniel & Simien 97 Lima Neto et al. 99 Simonneau & Prada 04 (n > 1) Trujillo et al. 02 Emsellem & van de Ven 08 new hybrid-1 (optimized for ncut) hybrid-2 (optimized for rcut)  0.1052 0.0905 0.0238 0.1496 0.0382 0.0005 0.0004 0.0004  0.1187 0.1021 0.0098  – –  0.0007 0.0005 0.0005  Fig. 2. Illustration of the accuracy of the PS formula with the LGM co- eﬃcients for pn. The solid curves show the numerically estimated pro- ﬁles, while the colored-dashed curves show the LGM approximation.  Notes: The rms accuracies are computed over the full range of radii −3 ≤ log(r/Re) ≤ 3 (100 steps) and 0.5 ≤ n ≤ 10 (50 steps), except for the SP formula, which does not allow n ≤ 1, and also avoiding the domain where ρ(r) < 10−30 ρ(Re). Trujillo proximation(cid:101)ρnew for n < 3.4 and(cid:101)ρEV for n ≥ 3.4. The ﬁrst hy- et al. (2002) and EV do not provide analytical mass proﬁles. The brid model has a mass proﬁle (cid:101)Mnew for n < 3 and (cid:101)MSP for n ≥ 3, lower two rows display hybrid models, both with our new ap- while in hybrid model 2, the mass proﬁle is (cid:101)Mnew for r < Re and (cid:101)MLGM for r ≥ Re.  3. Results As seen in Figure 2, the 3D density proﬁles depart from the power laws proposed by LGM at low n, especially for low radii, as expected by the asymptotic expansions of Baes & Gentile (2011) for n < 1. Interestingly, the LGM formula is also in- adequate at low radii for n = 1.25 and 2.25, although the asymp- totic expansion of Baes & Gentile indicate power-law behavior at small radii. This poor accuracy of the LGM approximation at low radii is a serious concern when performing kinematic mod- eling of systems with possible central massive black holes. For example, Gaia DR2 positions and proper motions for stars in nearby globular clusters extend inwards to 0.7 arcsec from the center, which translates to 0.002 Re.  We now compare the accuracy of the diﬀerent analytical ap- proximations for the 3D density and 3D mass proﬁles. Figure 3 displays the ratio log main analytical approximations available in the literature, along with our new model  (cid:16)(cid:101)fmodel /(cid:101)f (cid:17) , for (cid:101)f =(cid:101)ρ and (cid:101)f = (cid:101)M, for the  10(cid:88) 10−i(cid:88)  fnew(x, n) = fLGM(x, n) dex  ai, j logi x log j n   ,  (28)  i=0  j=0  where f is either the 3D density or 3D mass proﬁle. We see that our model presents a more continuous behavior over the full range of Sérsic indices and radii. Our approximation displays the smallest residuals among all models for n <∼ 3 (except that SP outperforms our model for mass estimates at r > 3 Re for n > 1.3).  The variation of accuracy with Sérsic index can be seen in , more detail in Figure 4, which displays the rms of log over the radial domain where ρ(r) > 10−30 ρ(Re), of the main an- alytical approximations, using 1000 log-spaced Sérsic indices. Figure 4 indicates that the SP (respectively, EV) approximation for density has rms relative accuracy worse than 2.3% (0.01 for ) for n < 1.6 (respectively 1.3). Our approxima- log tion (Eq. [28]) is more accurate than SP for n < 4.3 (density) and  (cid:16)(cid:101)fmodel /(cid:101)f (cid:17)  (cid:17) (cid:16)(cid:101)fmodel /(cid:101)f  Article number, page 4 of 8  n < 3.1 (mass), and is more accurate than EV for n < 3.4 (den- sity), except for their particular choices of n. Figure 4 shows that the EV approximation is much more accurate at speciﬁc values of n (note that our grid does not contain all of these values pre- cisely, so the EV approximation is even more accurate at these speciﬁc values of n). However, these speciﬁc values of n repre- sent a negligible measure compared to the full continuous range of 0.5 ≤ n ≤ 10. Therefore, the EV approximation at low n is not reliable for estimating the 3D density proﬁle.  (cid:16)(cid:101)fLGM /(cid:101)f (cid:17)  We analyzed the results shown in Figure 4 using bn from either CB or by numerically solving Eq. (2), and the results were very similar. In fact, the results are similar if we adopt one form of bn in the numerical integration and the other in the an- alytical approximations. This can be explained by the fact that is practically the same for both estimates of bn, log yielding a very similar ﬁt of Eq. (26). Finally, we provide in Table 1 the rms accuracies computed over the full range of radii −3 ≤ log(r/Re) ≤ 3 and 0.5 ≤ n ≤ 10, except for the SP formula, which does not allow n ≤ 1, and also avoiding the domain where ρ(r) < 10−30 ρ(Re). We see that, av- eraging over all Sérsic indices, our approximation is much more accurate than all others (with over 10 times lower rms).  4. Conclusions and Discussion The Sérsic model is usually considered to provide excellent ﬁts to the surface density (or surface brightness) proﬁles of elliptical galaxies, spiral bulges, and even dwarf spheroidal galaxies and globular clusters. In the past, many authors have used simple analytical models to describe these systems, arguing that their models, once projected, resemble Sérsic models. It is more rel- evant to compare the physically meaningful three-dimensional density proﬁles of these simple models to the deprojected Sérsic model.  This comparison is made in Appendix A for the Plummer, Jaﬀe, Hernquist, Einasto, and NFW models. As seen in Fig. A.1,  10−310−210−1100101102103r/Re10−310−210−1100101102103eρ×nΓ[n(3−p)]bn(3−p)×exp[b(r/Re)1/n]NumericalLGMn=0.75n=1.25n=2.25n=4.25n=8.25n=0.75n=1.25n=2.25n=4.25n=8.25Vitral & Mamon: Deprojection of the Sérsic Proﬁle  Fig. 3. Accuracy of deprojected density (top 6 panels) and mass (3 bottom panels) of the diﬀerent analytical approximations (LGM: Lima-Neto et al. 1999; SP: Simonneau & Prada 1999, 2004; Trujillo+02: Trujillo et al. 2002; EV: Emsellem & van de Ven 2008; our new one (Eq. [28], with green-colored titles) as a function of both Sérsic index (abscissae) and radii (ordinates). The color scale given in the vertical color bars are linear for log ratios between –0.001 and 0.001 and logarithmic beyond. The gray region and green curves in the upper left of the density panels are for regions where the numerical integration reached the underﬂow limit or density 10−30 times ρ(Re), respectively, because of the very rapid decline of density at large radii for low n, and also covers n < 1 that is not covered by the SP model. Note that the EV and Trujillo+02 models perform better at speciﬁc values of n that are often missed in our grid.  most of the simple models do not provide decent ﬁts to the de- projected Sérsic model, even for narrow ranges of the Sérsic in- dex. The Plummer model requires a low index at small radii, but a much higher index at large radii, and the normalized density proﬁle ﬁts poorly at most radii. The Hernquist model resembles the n = 2.8 deprojected Sérsic model at low radii and the n = 5.7 Sérsic at large radii. The NFW models resemble the n = 2.8 de-  projected Sérsic at low radii (consistent with the similarity of the projected Sérsic with NFW discovered by Łokas & Mamon 2001), but have a shallower slope at large radii than even the shallowest (n = 8) deprojected Sérsic model. On the other hand, the Jaﬀe model resembles the n = 5.7 model at all radii. More- over, as seen in Figure A.2, the Einasto model provides a fair representation (rms diﬀerence of density proﬁles normalized to  Article number, page 5 of 8  0.51251010−310−210−1100101102103log[eρPS/eρ]0.512510log[eρTrujillo+02/eρ]0.512510log[eρSP/eρ]0.51251010−310−210−1100101102103log[eρLGM/eρ]0.512510log[eρEV/eρ]0.512510log[eρnew/eρ]0.51251010−310−210−1100101102103loghfMLGM/fMi0.512510loghfMSP/fMi0.512510loghfMnew/fMi−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1−10−1−10−2−10−3010−310−210−1nr/ReA&A proofs: manuscript no. article_new  Fig. 4. Accuracy of diﬀerent approximations (LGM: Lima-Neto et al. 1999; SP: Simonneau & Prada 1999, 2004; EV: Emsellem & van de Ven 2008; our new one (Eq. [28]) as a function of Sérsic index. Note that the EV model performs better at speciﬁc values of n that are often missed in our logarithmic grid of 1000 values of n.  value at half-mass radius less than 0.1 dex) of the deprojected Sérsic model for n > 6.5.  We reconsidered the diﬀerent analytical deprojections of the Sérsic surface brightness (or surface density) proﬁle. We found that the analytical approximations present in the literature do not show satisfying results when the Sérsic index is in the range 0.5 ≤ n (cid:46) 1.5 (apart from the speciﬁc values of n given by Emsellem & van de Ven 2008). In particular, the power-law times exponential density proﬁle of Prugniel & Simien (1997) and Lima Neto et al. (1999) fails to reproduce the inner density proﬁles for low n, even up to n = 2.25 despite the power-law be- havior expected at small radii for n > 1 (Baes & Gentile 2011).  With an order 10 two-dimensional polynomial ﬁt, we pro- pose a new analytical approximation (Eq. [28]) that is precise over the range log 0.5 ≤ log n ≤ 1, for −3 ≤ log (r/Re) ≤ 3. Our approximation provides the highest precision when averag- ing over all values of Sérsic indices and radii (Table 1). While the approximations of Simonneau & Prada (1999, 2004) on one hand and of Emsellem & van de Ven (2008) on the other, are more accurate than ours for n > 4.3 and 3.4, respectively, ours is more accurate at lower Sérsic indices.  This is important for the study of astronomical sources with low Sérsic indexes, such as galaxy bulges, nuclear star clusters, dwarf spheroidal galaxies, and globular clusters. Moreover, our approximation of Eq. (28) to the density proﬁle is suﬃciently ac- curate for most scientiﬁc analyses for n > 3. But the user could use a hybrid approximation, combining either the Simonneau & Prada or Emsellem & van de Ven approximations for n ≥ 3.4 and ours for n < 3.4 (as shown in the last rows of Table 1). Finally, our analysis has the advantage of also providing a precise ap- proximation for the mass proﬁle, whereas no analytical expres- sion can be derived from the density proﬁle of Emsellem & van de Ven. Our Python 3 codes are available at https://github. com/eduardo-vitral/Vitral_Mamon2020a along with coef- ﬁcients of Tables B.1 and B.2.  Article number, page 6 of 8  These results will be useful in future mass-orbit modeling analyses of low-mass spherical systems, as we are preparing for globular clusters (Vitral & Mamon, in prep.).  References Abel, N. H. 1826, Journal für die reine und angewandte Mathematik, 1, 153 Baes, M. & Gentile, G. 2011, A&A, 525, A136 Baes, M. & van Hese, E. 2011, A&A, 534, A69 Barmby, P., McLaughlin, D. E., Harris, W. E., Harris, G. L. H., & Forbes, D. A.  2007, AJ, 133, 2764  Battaglia, G., Tolstoy, E., Helmi, A., et al. 2006, A&A, 459, 423 Binney, J. & Mamon, G. A. 1982, MNRAS, 200, 361 Caon, N., Capaccioli, M., & D’Onofrio, M. 1993, MNRAS, 265, 1013 Carson, D. J., Barth, A. J., Seth, A. C., et al. 2015, AJ, 149, 170 Ciotti, L. & Bertin, G. 1999, A&A, 352, 447 Ciotti, L., Mancino, A., & Pellegrini, S. 2019, MNRAS, 490, 2656 de Vaucouleurs, G. 1948, Annales d’Astrophysique, 11, 247 Einasto, J. 1965, Trudy Inst. Astroz. Alma-Ata, 51, 87 Emsellem, E. & van de Ven, G. 2008, ApJ, 674, 653 Hernquist, L. 1990, ApJ, 356, 359 Jaﬀe, W. 1983, MNRAS, 202, 995 Lima Neto, G. B., Gerbal, D., & Márquez, I. 1999, MNRAS, 309, 481 Łokas, E. L. & Mamon, G. A. 2001, MNRAS, 321, 155 Márquez, I., Lima Neto, G. B., Capelato, H., Durret, F., & Gerbal, D. 2000,  A&A, 353, 873  Mazure, A. & Capelato, H. V. 2002, A&A, 383, 384 Mellier, Y. & Mathez, G. 1987, A&A, 175, 1 Muñoz, R. R., Côté, P., Santana, F. A., et al. 2018, ApJ, 860, 66 Navarro, J. F., Frenk, C. S., & White, S. D. M. 1996, ApJ, 462, 563 Navarro, J. F., Hayashi, E., Power, C., et al. 2004, MNRAS, 349, 1039 Nusser, A. 2019, arXiv e-prints, arXiv:1907.08035 Plummer, H. C. 1911, MNRAS, 71, 460 Prugniel, P. & Simien, F. 1997, A&A, 321, 111 Sérsic, J. L. 1963, Bull. Assoc. Argentina de Astron., 6, 41 Sersic, J. L. 1968, Atlas de galaxias australes (Cordoba, Argentina: Observatorio  Simard, L., Mendel, J. T., Patton, D. R., Ellison, S. L., & McConnachie, A. W.  Simonneau, E. & Prada, F. 1999, unpublished preprint, submitted to MNRAS,  Astronomico)  2011, ApJS, 196, 11  arXiv:astro-ph/9906151  Simonneau, E. & Prada, F. 2004, Rev. Mexicana Astron. Astroﬁs., 40, 69 Trujillo, I., Asensio Ramos, A., Rubiño-Martín, J. A., et al. 2002, MNRAS, 333,  510  Widrow, L. M. & Dubinski, J. 2005, ApJ, 631, 838  0.511.5234510n10−610−510−410−310−210−1100101rmslog(cid:16)efmodel/ef(cid:17)f=ρf=Mmodel:LGMmodel:SPmodel:EVmodel:newmodel:LGMmodel:SPmodel:EVmodel:newVitral & Mamon: Deprojection of the Sérsic Proﬁle  relation rh/Re = (cid:80)3  satisﬁes γ(a, x)/Γ(a) = y.3 For Sérsic, the conversion was done by ﬁtting a order 3 polynomial and recovering the j=0 ai logi n, where {a0, a1, a2, a3} = {1.32491, 0.0545396, −0.0286632, 0.0035086}.  Fig. A.2. Comparison of Einasto and deprojected Sérsic density pro- ﬁles (both normalized to half-mass radius). Red: best-ﬁt Einasto index (dashed line is nEinasto = nSrsic). Blue: rms of best ﬁt.  The Einasto model, which is the 3D analog of the Sér- sic model, resembles the deprojected Sérsic model. Figure A.2 shows the best-ﬁt values of the Einasto index, nEinasto in terms of the Sérsic index. The relation (red curve) is almost one-to-one (dashed line). The ﬁgure also shows the rms over all radii and best-ﬁt indices (blue curve).  (A.1)  Appendix B: Coefﬁcients of polynomials for new  deprojected Sérsic models  In this section, we present Tables B.1, B.2, B.3 and B.4, contain-  ing the coeﬃcients ai j in Eq. (26), for (cid:101)f =(cid:101)ρ and (cid:101)f = (cid:101)M, as well  as for both Ciotti & Bertin (1999) approximation for bn and the exact solution from Eq. (2). The numbers in parentheses are the exponents: e.g. “1.234 (−3)” corresponds to 1.234 × 10−3. Coef- ﬁcients that are not followed by a number in parentheses have exponent zero.  Fig. A.1. Comparison of other known three-dimensional density pro- ﬁles and the deprojected Sérsic density proﬁle for certain values of the Sérsic index n. All density proﬁles are normalized to the value at the three-dimensional half-mass radius, rh (see text). The diﬀerent NFW models can be distinguished at low radii, where the density increases with rmax/a.  Appendix A: Comparison of deprojected Sérsic to  other popular models  Figure A.1 compares the density proﬁles, normalized to the half- mass radius rh, for which we applied the following relations:    a  a  a  a  a  a  a  1 +  1 +  1 +  1 +  (Jaﬀe) ,  (NFW) ,  (Plummer) ,  (Hernquist) ,  (cid:34) (cid:18) r (cid:18) r (cid:18) r  (cid:19)2(cid:35)−5/2 (cid:19)(cid:21)−2 (cid:18) r (cid:18) r (cid:19)(cid:21)−3 (cid:18) r (cid:19)(cid:21)−2 (cid:19)1/n(cid:35)  (cid:18) r (cid:19)−2(cid:20) (cid:19)−1(cid:20) (cid:19)−1(cid:20) (cid:34) −(cid:18) r (cid:104)(cid:16) 1 + 21/3(cid:17) (cid:16) (cid:17) (cid:16)−0.209 + 0.856 log c − 0.090 log2 c (cid:104)  1 1 + dex P(−1)(3n, 1/2)  (Einasto) .  (cid:105)n  exp  (cid:105)  √  √  2  3  a  /    ρ(r) ∝  rh a  =  The ratio of half-mass radius to scale radius rh/a is given by  (cid:17)  (Plummer) , (Jaﬀe) , (Hernquist) , (NFW), (Einasto) .  (A.2)  In Eq. (A.2) for NFW, c = rmax/a, where rmax is the max- imum allowed radius (because, contrary to all other mod- els discussed here, the NFW model has logarithmically diver- gent mass). Also, for Einasto, P(−1)(a, y) is the inverse regu- larized lower incomplete gamma function, i.e. x = P(−1)(a, y)  3 The inverse (regularized) incomplete gamma function is available in many computer languages, e.g. Python (scipy package), Fortran, Mat- lab, Mathematica, and Javascript.  Article number, page 7 of 8  10−310−210−1100101102103r/rh10−610−410−2100102104106ρ(r)/ρ(rh)NFW(3.5<rmax/a<20)PlummerHernquistJaﬀeS´ersicn=0.5n=0.71n=1.0n=1.41n=2.0n=2.83n=4.0n=5.66n=8.0S´ersicn=0.5n=0.71n=1.0n=1.41n=2.0n=2.83n=4.0n=5.66n=8.00.512510nS´ersic0.512510nEinastonEinasto=nS´ersic10−1100rmslog(cid:18)ρS´ersic(r)ρS´ersic(rh)ρEinasto(rh)ρEinasto(r)(cid:19)Table B.1. Coeﬃcients of equations (26) and (28), for (cid:101)f =(cid:101)ρ and bn calculated from Ciotti & Bertin (1999) accurate approximation.  A&A proofs: manuscript no. article_new  0  2  1  i\ j 1.573 (−3) −7.175 (−2) 5.017 (−3) 0 5.430 (−2) 1 −4.507 (−3) −8.623 (−3) 2.706 (−1) −1.134 2 −4.251 (−2) 6.921 (−2) 1.373 (−2) −2.444 (−2) −8.324 (−2) 3 1.428 (−3) −7.563 (−3) 2.897 (−4) 4 1.615 (−3) −1.112 (−2) 3.261 (−3) 5 −1.388 (−3) 6 −9.613 (−5) 5.901 (−4) −4.636 (−4) −4.867 (−4) 9.505 (−5) −1.801 (−4) 1.074 (−5) 5.734 (−5) 7 4.306 (−6) −2.496 (−5) 2.464 (−5) 8 4.229 (−6) 9 −2.924 (−6) 10 −2.117 (−8)  – – –  – –  –  6  4  3  5 4.047 (−1) −1.191  1.256 (−1) 2.298 (−1) −9.349 (−1) −3.113 (−1) 2.795 (−1) −1.923 (−1) −2.219 (−1) 5.385 (−2) −1.248 (−1) 1.272 (−2) −5.059 (−3) 4.043 (−4)  2.455 (−1) 5.052 7.078 (−1) −3.093 3.670 (−1) −1.381 (−1) 1.200 (−1) −4.310 (−2)  7 8.650 (−1) −7.980 2.664  1.318  8 1.178 5.065 −7.604 (−1)  9  10 −2.771 1.209 −1.162 – – – – – – – – – –  – – – – – – – – –  – – – – – – – –  Table B.2. Coeﬃcients of equation (26) and (28), for (cid:101)f = (cid:101)M and bn calculated from Ciotti & Bertin (1999) accurate approximation.  0  6  5  3  2  1  4.247 (−1) −6.904 (−1) −6.342 (−1)  i\ j 4 1.014 (−4) −3.794 (−2) 7.076 (−4) 2.785 (−2) 0 7.489 (−1) −1.700 1.557 (−2) −4.107 (−2) −6.114 (−2) −3.157 (−2) 1 2 −3.517 (−2) 5.740 (−2) 2.328 (−1) −9.638 (−1) 1.001 1.007 1.986 (−2) −2.017 (−2) −1.276 (−1) 3.000 (−1) −8.746 (−2) −4.227 (−1) 3 3.040 (−2) −7.734 (−2) 1.989 (−3) 1.274 (−3) −4.467 (−3) 7.555 (−2) −2.723 (−2) 4 8.720 (−3) −1.959 (−2) 3.494 (−3) 1.656 (−2) −6.196 (−3) 5 −2.853 (−3) 2.779 (−4) 6 −1.620 (−4) 1.411 (−4) −4.970 (−5) −3.006 (−4) 3.039 (−4) 7 8 9 −9.523 (−6) 10 −6.227 (−7)  2.557 (−4) −3.086 (−4) −2.993 (−4) 1.608 (−5) −2.203 (−6) −3.249 (−7)  Table B.3. Coeﬃcients of equation (26) and (28), for (cid:101)f =(cid:101)ρ and bn calculated from Eq. (2).  1.303 (−5)  – – – – – –  – – – – –  – – – –  – – –  – –  –  7 8.367 (−1) −8.413 2.706  5.508 −3.228 5.202 (−1) −1.817 (−1)  0  2  1  i\ j 1.573 (−3) −7.176 (−2) 5.017 (−3) 0 5.434 (−2) 1 −4.506 (−3) −8.634 (−3) 2 −4.251 (−2) 6.921 (−2) 2.706 (−1) −1.134 1.373 (−2) −2.443 (−2) −8.325 (−2) 3 2.912 (−4) 1.428 (−3) −7.564 (−3) 4 1.617 (−3) −1.112 (−2) 3.260 (−3) 5 −1.388 (−3) 6 −9.613 (−5) 5.900 (−4) −4.633 (−4) −4.872 (−4) 1.072 (−5) 9.505 (−5) −1.801 (−4) 5.735 (−5) 7 4.306 (−6) −2.496 (−5) 2.464 (−5) 8 4.229 (−6) 9 −2.924 (−6) 10 −2.113 (−8)  – – –  – –  –  6  4  3  5 4.048 (−1) −1.191  1.256 (−1) 2.298 (−1) −9.353 (−1) −3.103 (−1) 2.795 (−1) −1.922 (−1) −2.220 (−1) 5.385 (−2) −1.247 (−1) 1.272 (−2) −5.060 (−3) 4.045 (−4)  2.460 (−1) 5.051 7.077 (−1) −3.093 3.670 (−1) −1.381 (−1) 1.200 (−1) −4.310 (−2)  7 8.647 (−1) −7.979 2.664  1.318  Table B.4. Coeﬃcients of equation (26) and (28), for (cid:101)f = (cid:101)M and bn calculated from Eq. (2).  0  6  5  3  2  1  4.249 (−1) −6.912 (−1) −6.335 (−1)  i\ j 4 1.030 (−4) −3.796 (−2) 7.075 (−4) 2.788 (−2) 0 1.557 (−2) −4.107 (−2) −6.112 (−2) −3.088 (−2) 7.489 (−1) −1.700 1 2 −3.518 (−2) 5.740 (−2) 2.328 (−1) −9.638 (−1) 1.001 1.007 3.000 (−1) −8.743 (−2) −4.228 (−1) 1.986 (−2) −2.017 (−2) −1.276 (−1) 3 3.040 (−2) −7.734 (−2) 1.990 (−3) 1.274 (−3) −4.469 (−3) 7.556 (−2) −2.723 (−2) 4 8.720 (−3) −1.959 (−2) 3.494 (−3) 1.656 (−2) −6.195 (−3) 5 −2.853 (−3) 2.780 (−4) 6 −1.620 (−4) 1.412 (−4) −4.977 (−5) −3.007 (−4) 3.039 (−4) 7 8 9 −9.523 (−6) 10 −6.228 (−7)  2.557 (−4) −3.086 (−4) −2.993 (−4) 1.608 (−5) −2.209 (−6) −3.205 (−7)  1.303 (−5)  – – – – – –  – – – – –  – – – –  – – –  – –  –  7 8.375 (−1) −8.413 2.706  5.507 −3.228 5.203 (−1) −1.817 (−1)  8 2.565 5.055 −7.776 (−1)  – – – – – – – –  8 1.178 5.065 −7.605 (−1)  – – – – – – – –  8 2.563 5.055 −7.776 (−1)  – – – – – – – –  9  10 −4.115 1.622 −1.080 – – – – – – – – – –  – – – – – – – – –  9  10 −2.771 1.209 −1.162 – – – – – – – – – –  – – – – – – – – –  9  10 −4.113 1.621 −1.080 – – – – – – – – – –  – – – – – – – – –  – – – – – – –  – – – – – – –  – – – – – – –  – – – – – – –  – – – – – –  – – – – – –  – – – – –  – – – – –  – – – –  – – – –  Article number, page 8 of 8  